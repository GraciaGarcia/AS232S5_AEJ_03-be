# docker-compose up -d
# docker-compose down
version: '3'

services:
  backend:
    image: 60071325/gracia-garcia-ia-be:1.0
    container_name: aiome-be
    ports:
      - "${PORT:-8086}:${PORT:-8086}"
    environment:
      - PORT=${PORT:-8086}
      - DATABASE_URL=jdbc:postgresql://ep-lucky-band-acmf0c65-pooler.sa-east-1.aws.neon.tech:5432/apis?sslmode=require&channel_binding=require
      - DATABASE_USERNAME=neondb_owner
      - DATABASE_PASSWORD=npg_5hATvbrqKD9o
      - COPILOT_API_KEY=70d2b19518msh27c0dc634d2bfd1p1dea1djsncacae4126f0f
      - COPILOT_API_HOST=copilot11.p.rapidapi.com
      - COPILOT_API_URL=https://copilot11.p.rapidapi.com/
      - GEMINI_API_KEY=AIzaSyAWvrzXRCrTrP5LVQB4cDd5_ACvkqRh_vw
      - GEMINI_API_URL=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent
      - CORS_ALLOWED_ORIGINS=*
      - CORS_ALLOWED_METHODS=*
      - CORS_ALLOWED_HEADERS=*
    networks:
      - my-network

  frontend:
    image: 60071325/gracia-garcia-ia-fe:1.0
    container_name: aiome-fe
    ports:
      - "4200:4200"
    environment:
      - SERVER_URL=${SERVER_URL}
      - PORT=${PORT:-8086}
      - CODESPACE_NAME=${CODESPACE_NAME}
      - GITHUB_CODESPACES_PORT_FORWARDING_DOMAIN=${GITHUB_CODESPACES_PORT_FORWARDING_DOMAIN}
    networks:
      - my-network
    depends_on:
      - backend

# CREAR UNA RED EN ESTE COMPOSE PARA QUE SEA COMPARTIDA A FUTURO CON OTRO COMPOSE
networks:
  my-network:
    name: my-network
    driver: bridge

# Endpoint GET p√∫blico para testear:
# http://localhost:8086/v3/api-docs
# Frontend disponible en:
# http://localhost:4200
